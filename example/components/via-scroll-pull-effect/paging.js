module.exports=Behavior({behaviors:[],properties:{},data:{loadingMore:!0},lifetimes:{attached(){this.pagingSeting={pageNum:1,pageSize:10},this.pageNum=this.pagingSeting.pageNum,this.pageSize=this.pagingSeting.pageSize,this._loading=!1,this.initialParams={}}},methods:{initPage(t,a){this.pageNum=this.pagingSeting.pageNum,this.pageSize=this.pagingSeting.pageSize,this._requestFn=a,t&&Object.keys(t).length>0&&(this.initialParams={...this.initialParams,...t})},async initLoadData(t,a,i){const e={...this.initialParams,...t};this.mergeParams=e,this._loading||(e.pageNum=1,this.pageNum=1);try{const{data:t}=await this._requestFn(e),s=t.list||[],g="function"==typeof a?a(t):s,h=t.hasNextPage||!1;return this.hasNextPage=h,this.setData({loadingMore:h}),"function"==typeof i&&i(g),this.reSetPageSatatus(),!this._loading&&0===g.length&&this.setPageEmpty(),{list:g,hasNextPage:h}}catch(t){throw this.setPageError(),t}},async pullDownLoad(t,a,i){this.pageNum=this.pagingSeting.pageNum;try{if(this._requestFn){const{list:e,hasNextPage:s}=await this.initLoadData({...this.mergeParams,...t,pageNum:this.pagingSeting.pageNum,pageSize:this.pagingSeting.pageSize},a,i);return this.reSetPageSatatus(),0===e.length&&this.setPageEmpty(),this.hasNextPage=s,{list:e,hasNextPage:s}}if(this._loadrequestFn)return this.loadData(t,a,i)}catch(t){}finally{this.stopPullDownRefresh()}},async pullUpLoad(t,a,i){this._loading=!0;const e={...t,...this.mergeParams,pageNum:this.pageNum,pageSize:this.pagingSeting.pageSize},{list:s,hasNextPage:g}=await this.initLoadData(e,a,i);return this.hasNextPage=g,this._loading=!1,this.setData({loadingMore:g}),s}}});