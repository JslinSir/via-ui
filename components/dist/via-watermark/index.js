import{getFields}from"../utils/noderef";import{rpxToPx}from"../utils/base";Component({properties:{markStr:{type:String,value:""},fontSize:{type:Number,value:32},spaceWidth:{type:Number,value:300},spaceHeight:{type:Number,value:180}},data:{},lifetimes:{attached(){this.drawWhaterMark()}},methods:{async drawWhaterMark(){const t=await getFields(this,"#whater-marker-cavas",{node:!0,size:!0}),{markStr:e,fontSize:r,spaceWidth:a,spaceHeight:i}=this.properties,s=t[0].node,o=wx.getSystemInfoSync().pixelRatio,h=`normal ${rpxToPx(r)*o}px sans-serif`,p=e.substring(0,8),d=t[0].width,l=t[0].height;s.width=d*o,s.height=l*o;const n=s.getContext("2d");n.rotate(45*Math.PI/180);const x=rpxToPx(i)*o,f=rpxToPx(a)*o;for(let t=1;t<20;t++){this.darwText(n,p,h,0,x*t);for(let e=1;e<20;e++)this.darwText(n,p,h,f*e,x*t)}for(let t=0;t<20;t++){this.darwText(n,p,h,0,-x*t);for(let e=1;e<20;e++)this.darwText(n,p,h,f*e,-x*t)}},darwText(t,e,r,a,i){t.beginPath(),t.font=r,t.fillStyle="rgba(255,255,255,0.6)",t.fillText(e,a,i)}}});