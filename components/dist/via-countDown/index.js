import time from"../utils/time";Component({externalClasses:["class-down-style","class-day-style","class-time-style","class-u-style"],properties:{startDate:{type:Number,value:0},endDate:{type:Number,value:0},date:{type:String,value:null},isShowDay:{type:Boolean,value:!0},hu:{type:String,value:"时"},mu:{type:String,value:"分"},su:{type:String,value:"秒"}},observers:{date(t){const e=time.remainingTimeSeconds(this.properties.date);this.setData({endDate:e})},endDate(){this.initDate()}},data:{day:0,hou:0,min:0,sec:0,text:""},ready(){this.initDate()},detached(){this.countDownInterval&&clearInterval(this.countDownInterval)},methods:{initDate(){if(this.countDownInterval&&clearInterval(this.countDownInterval),this.data.startDate>0){const t=(new Date).getTime()/1e3;let e=t+this.data.startDate;const n=t+this.data.endDate;return this.countDown(e),void(this.countDownInterval=setInterval((()=>{if(!1===this.countDown(e)){const t=(new Date).getTime()/1e3;if(n>t)return e=n,this.countDown(e),this.setData({text:this.data.endText}),void this.triggerEvent("onStart");this.triggerEvent("onEnd"),clearInterval(this.countDownInterval)}}),1e3))}let t=(new Date).getTime()/1e3+this.data.endDate;this.countDown(t),this.setData({text:this.data.endText}),this.countDownInterval=setInterval((()=>{!1===this.countDown(t)&&(this.triggerEvent("onEnd"),clearInterval(this.countDownInterval))}),1e3)},countDown(t){const e=t-(new Date).getTime()/1e3;if(e<=0)return!1;let n=parseInt(e/86400),a=parseInt(e%86400/3600),s=parseInt(e%86400%3600/60),i=parseInt(e%86400%3600%60);return this.setData({day:n,hou:this.timeFormat(a),min:this.timeFormat(s),sec:this.timeFormat(i)}),!0},timeFormat:t=>(t<0&&(t=0),t<10?"0"+t:t)}});